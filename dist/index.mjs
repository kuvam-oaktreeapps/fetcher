var G=Object.defineProperty;var w=Object.getOwnPropertySymbols;var j=Object.prototype.hasOwnProperty,x=Object.prototype.propertyIsEnumerable;var q=(R,r,e)=>r in R?G(R,r,{enumerable:!0,configurable:!0,writable:!0,value:e}):R[r]=e,L=(R,r)=>{for(var e in r||(r={}))j.call(r,e)&&q(R,e,r[e]);if(w)for(var e of w(r))x.call(r,e)&&q(R,e,r[e]);return R};var s=(R,r,e)=>new Promise((t,d)=>{var T=l=>{try{c(e.next(l))}catch(E){d(E)}},h=l=>{try{c(e.throw(l))}catch(E){d(E)}},c=l=>l.done?t(l.value):Promise.resolve(l.value).then(T,h);c((e=e.apply(R,r)).next())});import{useEffect as P,useState as S}from"react";var U=class{constructor(r,e){this.defaultRequestOps={method:"GET",headers:{"Content-Type":"application/json"},body:null};this.baseUrl=r,this.headers=()=>L({"Content-Type":"application/json",Accept:"application/json"},e==null?void 0:e())}request(t){return s(this,arguments,function*(r,e=this.defaultRequestOps){var E;let d=null,T=null,h,c;try{h=yield fetch(this.baseUrl+r,{headers:L(L({},(E=this.headers)==null?void 0:E.call(this)),e==null?void 0:e.headers),method:e==null?void 0:e.method,body:e!=null&&e.body&&(e==null?void 0:e.method)!=="GET"?JSON.stringify(e==null?void 0:e.body):void 0})}catch(i){return console.error(i),T={status:0,fetchResponse:null,data:null},{data:d,error:T}}let l=yield h.text();try{c=l?JSON.parse(l):null}catch(i){c=l}return h.ok?d=c:T={status:h.status,fetchResponse:h,data:c},{data:d,error:T}})}use(r,e={method:"GET"}){let[t,d]=S(null),[T,h]=S(null),[c,l]=S(!0),E=()=>s(this,null,function*(){var u,f,g,y;l(!0),(u=e==null?void 0:e.onLoadingStart)==null||u.call(e);let{data:a,error:n}=yield this.request(r,{body:e==null?void 0:e.body,headers:e==null?void 0:e.headers,method:"GET"});return l(!1),(f=e==null?void 0:e.onLoadingEnd)==null||f.call(e),n?(h(n),(g=e==null?void 0:e.onError)==null||g.call(e,{status:n.status,fetchResponse:n.fetchResponse,data:a})):a?(d(a),(y=e==null?void 0:e.onSuccess)==null||y.call(e,a)):console.log("No data or error returned from request!"),{data:a,error:n}}),i=()=>s(this,null,function*(){var u,f,g,y;l(!0),(u=e==null?void 0:e.onLoadingStart)==null||u.call(e);let{data:a,error:n}=yield this.request(r,{body:e==null?void 0:e.body,headers:e==null?void 0:e.headers,method:(e==null?void 0:e.method)||"POST"});return l(!1),(f=e==null?void 0:e.onLoadingEnd)==null||f.call(e),n?(h(n),(g=e==null?void 0:e.onError)==null||g.call(e,{status:n.status,fetchResponse:n.fetchResponse,data:a})):a?(d(a),(y=e==null?void 0:e.onSuccess)==null||y.call(e,a)):console.log("No data or error returned from request!"),{data:a,error:n}});return P(()=>{e.method==="GET"&&E()},[]),{data:t,error:T,query:E,mutate:i,isLoading:c,isError:!!T}}useGET(r,e){let[t,d]=S(null),[T,h]=S(null),[c,l]=S(!0),E=()=>s(this,null,function*(){var u,f,g,y,O,m;let i=null,a=null;l(!0),(u=e==null?void 0:e.onLoadingStart)==null||u.call(e);let n=yield fetch(this.baseUrl+r,{headers:L(L({},(f=this.headers)==null?void 0:f.call(this)),e==null?void 0:e.headers)});if(n.status.toString().startsWith("2"))try{i=yield n.json(),d(i),(g=e==null?void 0:e.onSuccess)==null||g.call(e,i)}catch(b){i=yield n.text(),d(i),(y=e==null?void 0:e.onSuccess)==null||y.call(e,i)}else a={status:n.status,fetchResponse:n},h(a),(O=e==null?void 0:e.onError)==null||O.call(e,a);return l(!1),(m=e==null?void 0:e.onLoadingEnd)==null||m.call(e),{data:i,error:a}});return P(()=>{E()},[]),{data:t,isError:T,isLoading:c,refetchData:E}}usePOST(r,e){let[t,d]=S(null),[T,h]=S(null),[c,l]=S(!1);return{postData:i=>s(this,null,function*(){var f,g,y,O,m,b;let a=null,n=null;l(!0),(f=e==null?void 0:e.onLoadingStart)==null||f.call(e);let u=yield fetch(this.baseUrl+r,{method:"POST",headers:L(L({},(g=this.headers)==null?void 0:g.call(this)),e==null?void 0:e.headers),body:JSON.stringify(i)});if(u.status.toString().startsWith("2"))try{a=yield u.json(),d(a),(y=e==null?void 0:e.onSuccess)==null||y.call(e,a)}catch(D){a=yield u.text(),d(a),(O=e==null?void 0:e.onSuccess)==null||O.call(e,a)}else n={status:u.status,fetchResponse:u},h(n),(m=e==null?void 0:e.onError)==null||m.call(e,n);return l(!1),(b=e==null?void 0:e.onLoadingEnd)==null||b.call(e),{data:a,error:n}}),isError:T,isLoading:c,data:t}}useDELETE(r){let[e,t]=S(null),[d,T]=S(null),[h,c]=S(!1);return{isError:d,isLoading:h,deleteData:E=>s(this,null,function*(){var u,f,g,y,O,m;let i=null,a=null;c(!0),(u=r==null?void 0:r.onLoadingStart)==null||u.call(r);let n=yield fetch(this.baseUrl+E,{method:"DELETE",headers:L(L({},(f=this.headers)==null?void 0:f.call(this)),r==null?void 0:r.headers)});if(n.status.toString().startsWith("2"))try{i=yield n.json(),t(i),(g=r==null?void 0:r.onSuccess)==null||g.call(r,i)}catch(b){i=yield n.text(),t(i),(y=r==null?void 0:r.onSuccess)==null||y.call(r,i)}else a={status:n.status,fetchResponse:n},T(a),(O=r==null?void 0:r.onError)==null||O.call(r,a);return c(!1),(m=r==null?void 0:r.onLoadingEnd)==null||m.call(r),{data:i,error:a}}),data:e}}usePATCH(r){let[e,t]=S(null),[d,T]=S(null),[h,c]=S(!1);return{patchData:(E,i)=>s(this,null,function*(){var f,g,y,O,m,b;let a=null,n=null;c(!0),(f=r==null?void 0:r.onLoadingStart)==null||f.call(r);let u=yield fetch(this.baseUrl+E,{method:"PATCH",headers:L(L({},(g=this.headers)==null?void 0:g.call(this)),r==null?void 0:r.headers),body:JSON.stringify(i)});if(u.status.toString().startsWith("2"))try{let D=yield u.json();t(D),(y=r==null?void 0:r.onSuccess)==null||y.call(r,D)}catch(D){a=yield u.text(),t(a),(O=r==null?void 0:r.onSuccess)==null||O.call(r,a)}else n={status:u.status,fetchResponse:u},T(n),(m=r==null?void 0:r.onError)==null||m.call(r,n);return c(!1),(b=r==null?void 0:r.onLoadingEnd)==null||b.call(r),{data:a,error:n}}),isError:d,isLoading:h,data:e}}},k=R=>new U(R.baseUrl,R.headers);export{k as createFetcher};
