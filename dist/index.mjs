var C=Object.defineProperty;var b=Object.getOwnPropertySymbols;var G=Object.prototype.hasOwnProperty,j=Object.prototype.propertyIsEnumerable;var q=(y,r,e)=>r in y?C(y,r,{enumerable:!0,configurable:!0,writable:!0,value:e}):y[r]=e,L=(y,r)=>{for(var e in r||(r={}))G.call(r,e)&&q(y,e,r[e]);if(b)for(var e of b(r))j.call(r,e)&&q(y,e,r[e]);return y};var m=(y,r,e)=>new Promise((s,d)=>{var T=i=>{try{c(e.next(i))}catch(E){d(E)}},h=i=>{try{c(e.throw(i))}catch(E){d(E)}},c=i=>i.done?s(i.value):Promise.resolve(i.value).then(T,h);c((e=e.apply(y,r)).next())});import{useEffect as x,useState as S}from"react";var P=y=>y.replace(/\/$/g,"");var w=class{constructor(r,e){this.defaultRequestOps={method:"GET",headers:{"Content-Type":"application/json"},body:void 0};this.baseUrl=P(r),this.headers=()=>L({"Content-Type":"application/json",Accept:"application/json"},e==null?void 0:e())}request(s){return m(this,arguments,function*(r,e=this.defaultRequestOps){var E;let d=null,T=null,h,c;try{h=yield fetch(this.baseUrl+r,{headers:L(L({},(E=this.headers)==null?void 0:E.call(this)),e==null?void 0:e.headers),method:e==null?void 0:e.method,body:e!=null&&e.body&&(e==null?void 0:e.method)!=="GET"?JSON.stringify(e==null?void 0:e.body):void 0})}catch(u){return console.error(u),T={status:0,fetchResponse:null,data:null},{data:d,error:T}}let i=yield h.text();try{c=i?JSON.parse(i):null}catch(u){c=i}return h.ok?d=c:T={status:h.status,fetchResponse:h,data:c},{data:d,error:T}})}use(r,e={method:"GET"}){let[s,d]=S(null),[T,h]=S(null),[c,i]=S(!0),E=()=>m(this,null,function*(){var l,f,g,t;i(!0),(l=e==null?void 0:e.onLoadingStart)==null||l.call(e);let{data:n,error:a}=yield this.request(r,{headers:e==null?void 0:e.headers,method:"GET"});return i(!1),(f=e==null?void 0:e.onLoadingEnd)==null||f.call(e),a?(h(a),(g=e==null?void 0:e.onError)==null||g.call(e,{status:a.status,fetchResponse:a.fetchResponse,data:n})):n?(d(n),(t=e==null?void 0:e.onSuccess)==null||t.call(e,n)):console.log("No data or error returned from request!"),{data:n,error:a}}),u=n=>m(this,null,function*(){var f,g,t,R;i(!0),(f=e==null?void 0:e.onLoadingStart)==null||f.call(e);let{data:a,error:l}=yield this.request(r,{body:n,headers:e==null?void 0:e.headers,method:(e==null?void 0:e.method)||"POST"});return i(!1),(g=e==null?void 0:e.onLoadingEnd)==null||g.call(e),l?(h(l),(t=e==null?void 0:e.onError)==null||t.call(e,{status:l.status,fetchResponse:l.fetchResponse,data:a})):a?(d(a),(R=e==null?void 0:e.onSuccess)==null||R.call(e,a)):console.log("No data or error returned from request!"),{data:a,error:l}});return x(()=>{e.method==="GET"&&E()},[]),{data:s,error:T,query:E,mutate:u,isLoading:c,isError:!!T}}useGET(r,e){let[s,d]=S(null),[T,h]=S(null),[c,i]=S(!0),E=()=>m(this,null,function*(){var l,f,g,t,R,O;let u=null,n=null;i(!0),(l=e==null?void 0:e.onLoadingStart)==null||l.call(e);let a=yield fetch(this.baseUrl+r,{headers:L(L({},(f=this.headers)==null?void 0:f.call(this)),e==null?void 0:e.headers)});if(a.status.toString().startsWith("2"))try{u=yield a.json(),d(u),(g=e==null?void 0:e.onSuccess)==null||g.call(e,u)}catch(U){u=yield a.text(),d(u),(t=e==null?void 0:e.onSuccess)==null||t.call(e,u)}else n={status:a.status,fetchResponse:a},h(n),(R=e==null?void 0:e.onError)==null||R.call(e,n);return i(!1),(O=e==null?void 0:e.onLoadingEnd)==null||O.call(e),{data:u,error:n}});return x(()=>{E()},[]),{data:s,isError:T,isLoading:c,refetchData:E}}usePOST(r,e){let[s,d]=S(null),[T,h]=S(null),[c,i]=S(!1);return{postData:u=>m(this,null,function*(){var f,g,t,R,O,U;let n=null,a=null;i(!0),(f=e==null?void 0:e.onLoadingStart)==null||f.call(e);let l=yield fetch(this.baseUrl+r,{method:"POST",headers:L(L({},(g=this.headers)==null?void 0:g.call(this)),e==null?void 0:e.headers),body:JSON.stringify(u)});if(l.status.toString().startsWith("2"))try{n=yield l.json(),d(n),(t=e==null?void 0:e.onSuccess)==null||t.call(e,n)}catch(D){n=yield l.text(),d(n),(R=e==null?void 0:e.onSuccess)==null||R.call(e,n)}else a={status:l.status,fetchResponse:l},h(a),(O=e==null?void 0:e.onError)==null||O.call(e,a);return i(!1),(U=e==null?void 0:e.onLoadingEnd)==null||U.call(e),{data:n,error:a}}),isError:T,isLoading:c,data:s}}useDELETE(r){let[e,s]=S(null),[d,T]=S(null),[h,c]=S(!1);return{isError:d,isLoading:h,deleteData:E=>m(this,null,function*(){var l,f,g,t,R,O;let u=null,n=null;c(!0),(l=r==null?void 0:r.onLoadingStart)==null||l.call(r);let a=yield fetch(this.baseUrl+E,{method:"DELETE",headers:L(L({},(f=this.headers)==null?void 0:f.call(this)),r==null?void 0:r.headers)});if(a.status.toString().startsWith("2"))try{u=yield a.json(),s(u),(g=r==null?void 0:r.onSuccess)==null||g.call(r,u)}catch(U){u=yield a.text(),s(u),(t=r==null?void 0:r.onSuccess)==null||t.call(r,u)}else n={status:a.status,fetchResponse:a},T(n),(R=r==null?void 0:r.onError)==null||R.call(r,n);return c(!1),(O=r==null?void 0:r.onLoadingEnd)==null||O.call(r),{data:u,error:n}}),data:e}}usePATCH(r){let[e,s]=S(null),[d,T]=S(null),[h,c]=S(!1);return{patchData:(E,u)=>m(this,null,function*(){var f,g,t,R,O,U;let n=null,a=null;c(!0),(f=r==null?void 0:r.onLoadingStart)==null||f.call(r);let l=yield fetch(this.baseUrl+E,{method:"PATCH",headers:L(L({},(g=this.headers)==null?void 0:g.call(this)),r==null?void 0:r.headers),body:JSON.stringify(u)});if(l.status.toString().startsWith("2"))try{let D=yield l.json();s(D),(t=r==null?void 0:r.onSuccess)==null||t.call(r,D)}catch(D){n=yield l.text(),s(n),(R=r==null?void 0:r.onSuccess)==null||R.call(r,n)}else a={status:l.status,fetchResponse:l},T(a),(O=r==null?void 0:r.onError)==null||O.call(r,a);return c(!1),(U=r==null?void 0:r.onLoadingEnd)==null||U.call(r),{data:n,error:a}}),isError:d,isLoading:h,data:e}}},J=y=>new w(y.baseUrl,y.headers);export{J as createFetcher};
