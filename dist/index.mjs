var j=Object.defineProperty;var b=Object.getOwnPropertySymbols;var G=Object.prototype.hasOwnProperty,x=Object.prototype.propertyIsEnumerable;var q=(S,r,e)=>r in S?j(S,r,{enumerable:!0,configurable:!0,writable:!0,value:e}):S[r]=e,s=(S,r)=>{for(var e in r||(r={}))G.call(r,e)&&q(S,e,r[e]);if(b)for(var e of b(r))x.call(r,e)&&q(S,e,r[e]);return S};var m=(S,r,e)=>new Promise((R,d)=>{var T=l=>{try{c(e.next(l))}catch(E){d(E)}},h=l=>{try{c(e.throw(l))}catch(E){d(E)}},c=l=>l.done?R(l.value):Promise.resolve(l.value).then(T,h);c((e=e.apply(S,r)).next())});import{useEffect as P,useState as t}from"react";var U=class{constructor(r,e){this.defaultRequestOps={method:"GET",headers:{"Content-Type":"application/json"},body:null};this.baseUrl=r,this.headers=()=>s({"Content-Type":"application/json",Accept:"application/json"},e==null?void 0:e())}request(R){return m(this,arguments,function*(r,e=this.defaultRequestOps){var l;let d=null,T=null,h,c;try{h=yield fetch(this.baseUrl+r,{headers:s(s({},(l=this.headers)==null?void 0:l.call(this)),e==null?void 0:e.headers),method:e==null?void 0:e.method,body:JSON.stringify(e==null?void 0:e.body)})}catch(E){return console.error(E),T={status:0,fetchResponse:null,data:null},{data:d,error:T}}try{c=yield h.json()}catch(E){c=yield h.text()}return h.ok?d=c:T={status:h.status,fetchResponse:h,data:c},{data:d,error:T}})}use(r,e={method:"GET"}){let[R,d]=t(null),[T,h]=t(null),[c,l]=t(!0),E=()=>m(this,null,function*(){var i,f,g,y;l(!0),(i=e==null?void 0:e.onLoadingStart)==null||i.call(e);let{data:a,error:n}=yield this.request(r,{body:e==null?void 0:e.body,headers:e==null?void 0:e.headers,method:"GET"});return l(!1),(f=e==null?void 0:e.onLoadingEnd)==null||f.call(e),n?(h(n),(g=e==null?void 0:e.onError)==null||g.call(e,{status:n.status,fetchResponse:n.fetchResponse,data:a})):a?(d(a),(y=e==null?void 0:e.onSuccess)==null||y.call(e,a)):console.log("No data or error returned from request!"),{data:a,error:n}}),u=()=>m(this,null,function*(){var i,f,g,y;l(!0),(i=e==null?void 0:e.onLoadingStart)==null||i.call(e);let{data:a,error:n}=yield this.request(r,{body:e==null?void 0:e.body,headers:e==null?void 0:e.headers,method:(e==null?void 0:e.method)||"POST"});return l(!1),(f=e==null?void 0:e.onLoadingEnd)==null||f.call(e),n?(h(n),(g=e==null?void 0:e.onError)==null||g.call(e,{status:n.status,fetchResponse:n.fetchResponse,data:a})):a?(d(a),(y=e==null?void 0:e.onSuccess)==null||y.call(e,a)):console.log("No data or error returned from request!"),{data:a,error:n}});return P(()=>{e.method==="GET"&&E()},[]),{data:R,error:T,query:E,mutate:u,isLoading:c,isError:!!T}}useGET(r,e){let[R,d]=t(null),[T,h]=t(null),[c,l]=t(!0),E=()=>m(this,null,function*(){var i,f,g,y,L,O;let u=null,a=null;l(!0),(i=e==null?void 0:e.onLoadingStart)==null||i.call(e);let n=yield fetch(this.baseUrl+r,{headers:s(s({},(f=this.headers)==null?void 0:f.call(this)),e==null?void 0:e.headers)});if(n.status.toString().startsWith("2"))try{u=yield n.json(),d(u),(g=e==null?void 0:e.onSuccess)==null||g.call(e,u)}catch(w){u=yield n.text(),d(u),(y=e==null?void 0:e.onSuccess)==null||y.call(e,u)}else a={status:n.status,fetchResponse:n},h(a),(L=e==null?void 0:e.onError)==null||L.call(e,a);return l(!1),(O=e==null?void 0:e.onLoadingEnd)==null||O.call(e),{data:u,error:a}});return P(()=>{E()},[]),{data:R,isError:T,isLoading:c,refetchData:E}}usePOST(r,e){let[R,d]=t(null),[T,h]=t(null),[c,l]=t(!1);return{postData:u=>m(this,null,function*(){var f,g,y,L,O,w;let a=null,n=null;l(!0),(f=e==null?void 0:e.onLoadingStart)==null||f.call(e);let i=yield fetch(this.baseUrl+r,{method:"POST",headers:s(s({},(g=this.headers)==null?void 0:g.call(this)),e==null?void 0:e.headers),body:JSON.stringify(u)});if(i.status.toString().startsWith("2"))try{a=yield i.json(),d(a),(y=e==null?void 0:e.onSuccess)==null||y.call(e,a)}catch(D){a=yield i.text(),d(a),(L=e==null?void 0:e.onSuccess)==null||L.call(e,a)}else n={status:i.status,fetchResponse:i},h(n),(O=e==null?void 0:e.onError)==null||O.call(e,n);return l(!1),(w=e==null?void 0:e.onLoadingEnd)==null||w.call(e),{data:a,error:n}}),isError:T,isLoading:c,data:R}}useDELETE(r){let[e,R]=t(null),[d,T]=t(null),[h,c]=t(!1);return{isError:d,isLoading:h,deleteData:E=>m(this,null,function*(){var i,f,g,y,L,O;let u=null,a=null;c(!0),(i=r==null?void 0:r.onLoadingStart)==null||i.call(r);let n=yield fetch(this.baseUrl+E,{method:"DELETE",headers:s(s({},(f=this.headers)==null?void 0:f.call(this)),r==null?void 0:r.headers)});if(n.status.toString().startsWith("2"))try{u=yield n.json(),R(u),(g=r==null?void 0:r.onSuccess)==null||g.call(r,u)}catch(w){u=yield n.text(),R(u),(y=r==null?void 0:r.onSuccess)==null||y.call(r,u)}else a={status:n.status,fetchResponse:n},T(a),(L=r==null?void 0:r.onError)==null||L.call(r,a);return c(!1),(O=r==null?void 0:r.onLoadingEnd)==null||O.call(r),{data:u,error:a}}),data:e}}usePATCH(r){let[e,R]=t(null),[d,T]=t(null),[h,c]=t(!1);return{patchData:(E,u)=>m(this,null,function*(){var f,g,y,L,O,w;let a=null,n=null;c(!0),(f=r==null?void 0:r.onLoadingStart)==null||f.call(r);let i=yield fetch(this.baseUrl+E,{method:"PATCH",headers:s(s({},(g=this.headers)==null?void 0:g.call(this)),r==null?void 0:r.headers),body:JSON.stringify(u)});if(i.status.toString().startsWith("2"))try{let D=yield i.json();R(D),(y=r==null?void 0:r.onSuccess)==null||y.call(r,D)}catch(D){a=yield i.text(),R(a),(L=r==null?void 0:r.onSuccess)==null||L.call(r,a)}else n={status:i.status,fetchResponse:i},T(n),(O=r==null?void 0:r.onError)==null||O.call(r,n);return c(!1),(w=r==null?void 0:r.onLoadingEnd)==null||w.call(r),{data:a,error:n}}),isError:d,isLoading:h,data:e}}},A=S=>new U(S.baseUrl,S.headers);export{A as createFetcher};
