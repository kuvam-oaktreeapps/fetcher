var j=Object.defineProperty;var U=Object.getOwnPropertySymbols;var G=Object.prototype.hasOwnProperty,x=Object.prototype.propertyIsEnumerable;var q=(R,r,e)=>r in R?j(R,r,{enumerable:!0,configurable:!0,writable:!0,value:e}):R[r]=e,t=(R,r)=>{for(var e in r||(r={}))G.call(r,e)&&q(R,e,r[e]);if(U)for(var e of U(r))x.call(r,e)&&q(R,e,r[e]);return R};var b=(R,r,e)=>new Promise((L,d)=>{var T=l=>{try{c(e.next(l))}catch(E){d(E)}},h=l=>{try{c(e.throw(l))}catch(E){d(E)}},c=l=>l.done?L(l.value):Promise.resolve(l.value).then(T,h);c((e=e.apply(R,r)).next())});import{useEffect as P,useState as S}from"react";var D=class{constructor(r,e){this.defaultRequestOps={method:"GET",headers:{"Content-Type":"application/json"},body:null};this.baseUrl=r,this.headers=()=>t({"Content-Type":"application/json",Accept:"application/json"},e==null?void 0:e())}request(L){return b(this,arguments,function*(r,e=this.defaultRequestOps){var l;let d=null,T=null,h,c;try{h=yield fetch(this.baseUrl+r,{headers:t(t({},(l=this.headers)==null?void 0:l.call(this)),e==null?void 0:e.headers),method:e==null?void 0:e.method,body:e!=null&&e.body&&(e==null?void 0:e.method)!=="GET"?JSON.stringify(e==null?void 0:e.body):void 0})}catch(E){return console.error(E),T={status:0,fetchResponse:null,data:null},{data:d,error:T}}try{c=yield h.json()}catch(E){c=yield h.text()}return h.ok?d=c:T={status:h.status,fetchResponse:h,data:c},{data:d,error:T}})}use(r,e={method:"GET"}){let[L,d]=S(null),[T,h]=S(null),[c,l]=S(!0),E=()=>b(this,null,function*(){var i,f,g,y;l(!0),(i=e==null?void 0:e.onLoadingStart)==null||i.call(e);let{data:a,error:n}=yield this.request(r,{body:e==null?void 0:e.body,headers:e==null?void 0:e.headers,method:"GET"});return l(!1),(f=e==null?void 0:e.onLoadingEnd)==null||f.call(e),n?(h(n),(g=e==null?void 0:e.onError)==null||g.call(e,{status:n.status,fetchResponse:n.fetchResponse,data:a})):a?(d(a),(y=e==null?void 0:e.onSuccess)==null||y.call(e,a)):console.log("No data or error returned from request!"),{data:a,error:n}}),u=()=>b(this,null,function*(){var i,f,g,y;l(!0),(i=e==null?void 0:e.onLoadingStart)==null||i.call(e);let{data:a,error:n}=yield this.request(r,{body:e==null?void 0:e.body,headers:e==null?void 0:e.headers,method:(e==null?void 0:e.method)||"POST"});return l(!1),(f=e==null?void 0:e.onLoadingEnd)==null||f.call(e),n?(h(n),(g=e==null?void 0:e.onError)==null||g.call(e,{status:n.status,fetchResponse:n.fetchResponse,data:a})):a?(d(a),(y=e==null?void 0:e.onSuccess)==null||y.call(e,a)):console.log("No data or error returned from request!"),{data:a,error:n}});return P(()=>{e.method==="GET"&&E()},[]),{data:L,error:T,query:E,mutate:u,isLoading:c,isError:!!T}}useGET(r,e){let[L,d]=S(null),[T,h]=S(null),[c,l]=S(!0),E=()=>b(this,null,function*(){var i,f,g,y,O,m;let u=null,a=null;l(!0),(i=e==null?void 0:e.onLoadingStart)==null||i.call(e);let n=yield fetch(this.baseUrl+r,{headers:t(t({},(f=this.headers)==null?void 0:f.call(this)),e==null?void 0:e.headers)});if(n.status.toString().startsWith("2"))try{u=yield n.json(),d(u),(g=e==null?void 0:e.onSuccess)==null||g.call(e,u)}catch(s){u=yield n.text(),d(u),(y=e==null?void 0:e.onSuccess)==null||y.call(e,u)}else a={status:n.status,fetchResponse:n},h(a),(O=e==null?void 0:e.onError)==null||O.call(e,a);return l(!1),(m=e==null?void 0:e.onLoadingEnd)==null||m.call(e),{data:u,error:a}});return P(()=>{E()},[]),{data:L,isError:T,isLoading:c,refetchData:E}}usePOST(r,e){let[L,d]=S(null),[T,h]=S(null),[c,l]=S(!1);return{postData:u=>b(this,null,function*(){var f,g,y,O,m,s;let a=null,n=null;l(!0),(f=e==null?void 0:e.onLoadingStart)==null||f.call(e);let i=yield fetch(this.baseUrl+r,{method:"POST",headers:t(t({},(g=this.headers)==null?void 0:g.call(this)),e==null?void 0:e.headers),body:JSON.stringify(u)});if(i.status.toString().startsWith("2"))try{a=yield i.json(),d(a),(y=e==null?void 0:e.onSuccess)==null||y.call(e,a)}catch(w){a=yield i.text(),d(a),(O=e==null?void 0:e.onSuccess)==null||O.call(e,a)}else n={status:i.status,fetchResponse:i},h(n),(m=e==null?void 0:e.onError)==null||m.call(e,n);return l(!1),(s=e==null?void 0:e.onLoadingEnd)==null||s.call(e),{data:a,error:n}}),isError:T,isLoading:c,data:L}}useDELETE(r){let[e,L]=S(null),[d,T]=S(null),[h,c]=S(!1);return{isError:d,isLoading:h,deleteData:E=>b(this,null,function*(){var i,f,g,y,O,m;let u=null,a=null;c(!0),(i=r==null?void 0:r.onLoadingStart)==null||i.call(r);let n=yield fetch(this.baseUrl+E,{method:"DELETE",headers:t(t({},(f=this.headers)==null?void 0:f.call(this)),r==null?void 0:r.headers)});if(n.status.toString().startsWith("2"))try{u=yield n.json(),L(u),(g=r==null?void 0:r.onSuccess)==null||g.call(r,u)}catch(s){u=yield n.text(),L(u),(y=r==null?void 0:r.onSuccess)==null||y.call(r,u)}else a={status:n.status,fetchResponse:n},T(a),(O=r==null?void 0:r.onError)==null||O.call(r,a);return c(!1),(m=r==null?void 0:r.onLoadingEnd)==null||m.call(r),{data:u,error:a}}),data:e}}usePATCH(r){let[e,L]=S(null),[d,T]=S(null),[h,c]=S(!1);return{patchData:(E,u)=>b(this,null,function*(){var f,g,y,O,m,s;let a=null,n=null;c(!0),(f=r==null?void 0:r.onLoadingStart)==null||f.call(r);let i=yield fetch(this.baseUrl+E,{method:"PATCH",headers:t(t({},(g=this.headers)==null?void 0:g.call(this)),r==null?void 0:r.headers),body:JSON.stringify(u)});if(i.status.toString().startsWith("2"))try{let w=yield i.json();L(w),(y=r==null?void 0:r.onSuccess)==null||y.call(r,w)}catch(w){a=yield i.text(),L(a),(O=r==null?void 0:r.onSuccess)==null||O.call(r,a)}else n={status:i.status,fetchResponse:i},T(n),(m=r==null?void 0:r.onError)==null||m.call(r,n);return c(!1),(s=r==null?void 0:r.onLoadingEnd)==null||s.call(r),{data:a,error:n}}),isError:d,isLoading:h,data:e}}},A=R=>new D(R.baseUrl,R.headers);export{A as createFetcher};
