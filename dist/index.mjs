var k=Object.defineProperty;var b=Object.getOwnPropertySymbols;var x=Object.prototype.hasOwnProperty,C=Object.prototype.propertyIsEnumerable;var q=(S,r,e)=>r in S?k(S,r,{enumerable:!0,configurable:!0,writable:!0,value:e}):S[r]=e,L=(S,r)=>{for(var e in r||(r={}))x.call(r,e)&&q(S,e,r[e]);if(b)for(var e of b(r))C.call(r,e)&&q(S,e,r[e]);return S};var O=(S,r,e)=>new Promise((R,d)=>{var h=u=>{try{c(e.next(u))}catch(T){d(T)}},t=u=>{try{c(e.throw(u))}catch(T){d(T)}},c=u=>u.done?R(u.value):Promise.resolve(u.value).then(h,t);c((e=e.apply(S,r)).next())});import{useEffect as j,useState as E}from"react";var P=S=>S.replace(/\/$/g,"");var D=class{constructor(r,e){this.defaultRequestOps={method:"GET",headers:{"Content-Type":"application/json"},body:void 0,params:{}};this.baseUrl=P(r),this.headers=()=>L({"Content-Type":"application/json",Accept:"application/json"},e==null?void 0:e())}request(R){return O(this,arguments,function*(r,e=this.defaultRequestOps){var i;let d=null,h=null,t,c,u=new URL(this.baseUrl+r);Object.keys(e.params||{}).length>0&&(u.search=new URLSearchParams(e.params).toString()),Array.from(u.searchParams);try{t=yield fetch(u,{headers:L(L({},(i=this.headers)==null?void 0:i.call(this)),e==null?void 0:e.headers),method:e==null?void 0:e.method,body:e!=null&&e.body&&(e==null?void 0:e.method)!=="GET"?JSON.stringify(e==null?void 0:e.body):void 0})}catch(l){return console.error(l),h={status:0,fetchResponse:null,data:null},{data:d,error:h}}let T=yield t.text();try{c=T?JSON.parse(T):null}catch(l){c=T}return t.ok?d=c:h={status:t.status,fetchResponse:t,data:c},{data:d,error:h}})}useQuery(r,e){let[R,d]=E(null),[h,t]=E(null),[c,u]=E(!0),T=(...l)=>O(this,[...l],function*(i={}){var f,g,s,y;u(!0),(f=e==null?void 0:e.onLoadingStart)==null||f.call(e);let{data:a,error:n}=yield this.request(r,{headers:e==null?void 0:e.headers,method:(e==null?void 0:e.method)||"GET",params:i});return u(!1),(g=e==null?void 0:e.onLoadingEnd)==null||g.call(e),n?(t(n),(s=e==null?void 0:e.onError)==null||s.call(e,{status:n.status,fetchResponse:n.fetchResponse,data:a})):a?(d(a),(y=e==null?void 0:e.onSuccess)==null||y.call(e,a)):console.log("No data or error returned from request!"),{data:a,error:n}});return j(()=>{T()},[]),{data:R,error:h,refetch:T,isLoading:c,isError:!!h}}useMutation(r,e){let[R,d]=E(null),[h,t]=E(null),[c,u]=E(!0);return{data:R,error:h,mutate:(i,l)=>O(this,null,function*(){var f,g,s,y;u(!0),(f=e==null?void 0:e.onLoadingStart)==null||f.call(e);let{data:a,error:n}=yield this.request(r,{body:i,headers:e==null?void 0:e.headers,method:(e==null?void 0:e.method)||"POST",params:l});return u(!1),(g=e==null?void 0:e.onLoadingEnd)==null||g.call(e),n?(t(n),(s=e==null?void 0:e.onError)==null||s.call(e,{status:n.status,fetchResponse:n.fetchResponse,data:a})):a?(d(a),(y=e==null?void 0:e.onSuccess)==null||y.call(e,a)):console.log("No data or error returned from request!"),{data:a,error:n}}),isLoading:c,isError:!!h}}useGET(r,e){let[R,d]=E(null),[h,t]=E(null),[c,u]=E(!0),T=()=>O(this,null,function*(){var n,f,g,s,y,m;let i=null,l=null;u(!0),(n=e==null?void 0:e.onLoadingStart)==null||n.call(e);let a=yield fetch(this.baseUrl+r,{headers:L(L({},(f=this.headers)==null?void 0:f.call(this)),e==null?void 0:e.headers)});if(a.status.toString().startsWith("2"))try{i=yield a.json(),d(i),(g=e==null?void 0:e.onSuccess)==null||g.call(e,i)}catch(U){i=yield a.text(),d(i),(s=e==null?void 0:e.onSuccess)==null||s.call(e,i)}else l={status:a.status,fetchResponse:a},t(l),(y=e==null?void 0:e.onError)==null||y.call(e,l);return u(!1),(m=e==null?void 0:e.onLoadingEnd)==null||m.call(e),{data:i,error:l}});return j(()=>{T()},[]),{data:R,isError:h,isLoading:c,refetchData:T}}usePOST(r,e){let[R,d]=E(null),[h,t]=E(null),[c,u]=E(!1);return{postData:i=>O(this,null,function*(){var f,g,s,y,m,U;let l=null,a=null;u(!0),(f=e==null?void 0:e.onLoadingStart)==null||f.call(e);let n=yield fetch(this.baseUrl+r,{method:"POST",headers:L(L({},(g=this.headers)==null?void 0:g.call(this)),e==null?void 0:e.headers),body:JSON.stringify(i)});if(n.status.toString().startsWith("2"))try{l=yield n.json(),d(l),(s=e==null?void 0:e.onSuccess)==null||s.call(e,l)}catch(w){l=yield n.text(),d(l),(y=e==null?void 0:e.onSuccess)==null||y.call(e,l)}else a={status:n.status,fetchResponse:n},t(a),(m=e==null?void 0:e.onError)==null||m.call(e,a);return u(!1),(U=e==null?void 0:e.onLoadingEnd)==null||U.call(e),{data:l,error:a}}),isError:h,isLoading:c,data:R}}useDELETE(r){let[e,R]=E(null),[d,h]=E(null),[t,c]=E(!1);return{isError:d,isLoading:t,deleteData:T=>O(this,null,function*(){var n,f,g,s,y,m;let i=null,l=null;c(!0),(n=r==null?void 0:r.onLoadingStart)==null||n.call(r);let a=yield fetch(this.baseUrl+T,{method:"DELETE",headers:L(L({},(f=this.headers)==null?void 0:f.call(this)),r==null?void 0:r.headers)});if(a.status.toString().startsWith("2"))try{i=yield a.json(),R(i),(g=r==null?void 0:r.onSuccess)==null||g.call(r,i)}catch(U){i=yield a.text(),R(i),(s=r==null?void 0:r.onSuccess)==null||s.call(r,i)}else l={status:a.status,fetchResponse:a},h(l),(y=r==null?void 0:r.onError)==null||y.call(r,l);return c(!1),(m=r==null?void 0:r.onLoadingEnd)==null||m.call(r),{data:i,error:l}}),data:e}}usePATCH(r){let[e,R]=E(null),[d,h]=E(null),[t,c]=E(!1);return{patchData:(T,i)=>O(this,null,function*(){var f,g,s,y,m,U;let l=null,a=null;c(!0),(f=r==null?void 0:r.onLoadingStart)==null||f.call(r);let n=yield fetch(this.baseUrl+T,{method:"PATCH",headers:L(L({},(g=this.headers)==null?void 0:g.call(this)),r==null?void 0:r.headers),body:JSON.stringify(i)});if(n.status.toString().startsWith("2"))try{let w=yield n.json();R(w),(s=r==null?void 0:r.onSuccess)==null||s.call(r,w)}catch(w){l=yield n.text(),R(l),(y=r==null?void 0:r.onSuccess)==null||y.call(r,l)}else a={status:n.status,fetchResponse:n},h(a),(m=r==null?void 0:r.onError)==null||m.call(r,a);return c(!1),(U=r==null?void 0:r.onLoadingEnd)==null||U.call(r),{data:l,error:a}}),isError:d,isLoading:t,data:e}}},J=S=>new D(S.baseUrl,S.headers);export{J as createFetcher};
