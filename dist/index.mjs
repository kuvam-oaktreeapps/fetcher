var C=Object.defineProperty;var b=Object.getOwnPropertySymbols;var j=Object.prototype.hasOwnProperty,G=Object.prototype.propertyIsEnumerable;var q=(s,r,e)=>r in s?C(s,r,{enumerable:!0,configurable:!0,writable:!0,value:e}):s[r]=e,R=(s,r)=>{for(var e in r||(r={}))j.call(r,e)&&q(s,e,r[e]);if(b)for(var e of b(r))G.call(r,e)&&q(s,e,r[e]);return s};var m=(s,r,e)=>new Promise((y,d)=>{var h=i=>{try{c(e.next(i))}catch(E){d(E)}},T=i=>{try{c(e.throw(i))}catch(E){d(E)}},c=i=>i.done?y(i.value):Promise.resolve(i.value).then(h,T);c((e=e.apply(s,r)).next())});import{useEffect as x,useState as t}from"react";var P=s=>s.replace(/\/$/g,"");var w=class{constructor(r,e){this.defaultRequestOps={method:"GET",headers:{"Content-Type":"application/json"},body:void 0};this.baseUrl=P(r),this.headers=()=>R({"Content-Type":"application/json",Accept:"application/json"},e==null?void 0:e())}request(y){return m(this,arguments,function*(r,e=this.defaultRequestOps){var E;let d=null,h=null,T,c;try{T=yield fetch(this.baseUrl+r,{headers:R(R({},(E=this.headers)==null?void 0:E.call(this)),e==null?void 0:e.headers),method:e==null?void 0:e.method,body:e!=null&&e.body&&(e==null?void 0:e.method)!=="GET"?JSON.stringify(e==null?void 0:e.body):void 0})}catch(n){return console.error(n),h={status:0,fetchResponse:null,data:null},{data:d,error:h}}let i=yield T.text();try{c=i?JSON.parse(i):null}catch(n){c=i}return T.ok?d=c:h={status:T.status,fetchResponse:T,data:c},{data:d,error:h}})}useQuery(r,e){let[y,d]=t(null),[h,T]=t(null),[c,i]=t(!0),E=()=>m(this,null,function*(){var l,u,f,g;i(!0),(l=e==null?void 0:e.onLoadingStart)==null||l.call(e);let{data:n,error:a}=yield this.request(r,{headers:e==null?void 0:e.headers,method:(e==null?void 0:e.method)||"GET"});return i(!1),(u=e==null?void 0:e.onLoadingEnd)==null||u.call(e),a?(T(a),(f=e==null?void 0:e.onError)==null||f.call(e,{status:a.status,fetchResponse:a.fetchResponse,data:n})):n?(d(n),(g=e==null?void 0:e.onSuccess)==null||g.call(e,n)):console.log("No data or error returned from request!"),{data:n,error:a}});return x(()=>{E()},[]),{data:y,error:h,refetch:E,isLoading:c,isError:!!h}}useMutation(r,e){let[y,d]=t(null),[h,T]=t(null),[c,i]=t(!0);return{data:y,error:h,mutate:n=>m(this,null,function*(){var u,f,g,S;i(!0),(u=e==null?void 0:e.onLoadingStart)==null||u.call(e);let{data:a,error:l}=yield this.request(r,{body:n,headers:e==null?void 0:e.headers,method:(e==null?void 0:e.method)||"POST"});return i(!1),(f=e==null?void 0:e.onLoadingEnd)==null||f.call(e),l?(T(l),(g=e==null?void 0:e.onError)==null||g.call(e,{status:l.status,fetchResponse:l.fetchResponse,data:a})):a?(d(a),(S=e==null?void 0:e.onSuccess)==null||S.call(e,a)):console.log("No data or error returned from request!"),{data:a,error:l}}),isLoading:c,isError:!!h}}useGET(r,e){let[y,d]=t(null),[h,T]=t(null),[c,i]=t(!0),E=()=>m(this,null,function*(){var u,f,g,S,L,O;let n=null,a=null;i(!0),(u=e==null?void 0:e.onLoadingStart)==null||u.call(e);let l=yield fetch(this.baseUrl+r,{headers:R(R({},(f=this.headers)==null?void 0:f.call(this)),e==null?void 0:e.headers)});if(l.status.toString().startsWith("2"))try{n=yield l.json(),d(n),(g=e==null?void 0:e.onSuccess)==null||g.call(e,n)}catch(U){n=yield l.text(),d(n),(S=e==null?void 0:e.onSuccess)==null||S.call(e,n)}else a={status:l.status,fetchResponse:l},T(a),(L=e==null?void 0:e.onError)==null||L.call(e,a);return i(!1),(O=e==null?void 0:e.onLoadingEnd)==null||O.call(e),{data:n,error:a}});return x(()=>{E()},[]),{data:y,isError:h,isLoading:c,refetchData:E}}usePOST(r,e){let[y,d]=t(null),[h,T]=t(null),[c,i]=t(!1);return{postData:n=>m(this,null,function*(){var f,g,S,L,O,U;let a=null,l=null;i(!0),(f=e==null?void 0:e.onLoadingStart)==null||f.call(e);let u=yield fetch(this.baseUrl+r,{method:"POST",headers:R(R({},(g=this.headers)==null?void 0:g.call(this)),e==null?void 0:e.headers),body:JSON.stringify(n)});if(u.status.toString().startsWith("2"))try{a=yield u.json(),d(a),(S=e==null?void 0:e.onSuccess)==null||S.call(e,a)}catch(D){a=yield u.text(),d(a),(L=e==null?void 0:e.onSuccess)==null||L.call(e,a)}else l={status:u.status,fetchResponse:u},T(l),(O=e==null?void 0:e.onError)==null||O.call(e,l);return i(!1),(U=e==null?void 0:e.onLoadingEnd)==null||U.call(e),{data:a,error:l}}),isError:h,isLoading:c,data:y}}useDELETE(r){let[e,y]=t(null),[d,h]=t(null),[T,c]=t(!1);return{isError:d,isLoading:T,deleteData:E=>m(this,null,function*(){var u,f,g,S,L,O;let n=null,a=null;c(!0),(u=r==null?void 0:r.onLoadingStart)==null||u.call(r);let l=yield fetch(this.baseUrl+E,{method:"DELETE",headers:R(R({},(f=this.headers)==null?void 0:f.call(this)),r==null?void 0:r.headers)});if(l.status.toString().startsWith("2"))try{n=yield l.json(),y(n),(g=r==null?void 0:r.onSuccess)==null||g.call(r,n)}catch(U){n=yield l.text(),y(n),(S=r==null?void 0:r.onSuccess)==null||S.call(r,n)}else a={status:l.status,fetchResponse:l},h(a),(L=r==null?void 0:r.onError)==null||L.call(r,a);return c(!1),(O=r==null?void 0:r.onLoadingEnd)==null||O.call(r),{data:n,error:a}}),data:e}}usePATCH(r){let[e,y]=t(null),[d,h]=t(null),[T,c]=t(!1);return{patchData:(E,n)=>m(this,null,function*(){var f,g,S,L,O,U;let a=null,l=null;c(!0),(f=r==null?void 0:r.onLoadingStart)==null||f.call(r);let u=yield fetch(this.baseUrl+E,{method:"PATCH",headers:R(R({},(g=this.headers)==null?void 0:g.call(this)),r==null?void 0:r.headers),body:JSON.stringify(n)});if(u.status.toString().startsWith("2"))try{let D=yield u.json();y(D),(S=r==null?void 0:r.onSuccess)==null||S.call(r,D)}catch(D){a=yield u.text(),y(a),(L=r==null?void 0:r.onSuccess)==null||L.call(r,a)}else l={status:u.status,fetchResponse:u},h(l),(O=r==null?void 0:r.onError)==null||O.call(r,l);return c(!1),(U=r==null?void 0:r.onLoadingEnd)==null||U.call(r),{data:a,error:l}}),isError:d,isLoading:T,data:e}}},J=s=>new w(s.baseUrl,s.headers);export{J as createFetcher};
